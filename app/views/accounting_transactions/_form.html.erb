<div class='row'>
  <div class='col-xs-12 col-sm-offset-2 col-sm-8'>
    <% if @accounting_transaction.id %>
      <div class='row'>
        <div class='col-sm-10'><h2>Update existing accounting transaction for <%= link_to_account_book  %></h2></div>
        <div class='col-sm-2'><h2 style='text-align : left'><%= link_to "delete" , { :controller => "accounting_transactions" , :action => "destroy" } , :method => "delete" , :class => "btn btn-danger" , :data => { :confirm => "Are you sure you want to delete this transaction?" } %></h2></div>
      </div>
    <% else %>
      <h2>Create a new accounting transaction for <%= link_to_account_book %></h2>
    <% end %>
    <% 
    if @accounting_transaction.id
      form_url = { :action => "update" , :controller => "accounting_transactions" , :account_book_id => @accounting_transaction.account_book.id , :id => @accounting_transaction.id }
    else
      form_url = { :action => "create" , :controller => "accounting_transactions" , :account_book_id => @accounting_transaction.account_book.id }
    end
    %>
    <%= form_for(@accounting_transaction , :url =>  form_url, :html => { 
      :method => (@accounting_transaction.id ? "patch" : "post") 
      }) do |f| %>
      <%= render "shared/error_messages" , object: f.object %>
      <div class='form-group'>
        <%= f.label :description %>
        <%= f.text_area :description, :class => "form-control" , :required => true , :"ng-model" => "accounting_transaction.description" %>
      </div>
      <div class="form-group">
          <%= f.label :created_at , "Date / Time of transaction (defaults to date of transaction creation)" %>
          <%= f.datetime_local_field :created_at , :class => "form-control" , :"ng-model" => "accounting_transaction.created_at" %>
      </div>
      <div class='row'>
        <div id='debit_records' class='col-sm-6'>
          <h2>Debit Records</h2><button type="button" id='create_new_debit_entry' class="btn btn-default">Add new debit record</button>
            <%= f.fields_for(:debit_records) do |ff| %>
              <h4>Record</h4>
              <%= ff.hidden_field :id %>

              <div class='form-group'>
                <%= ff.label :account_name %>
                <%= ff.text_field :account_name, :class => "form-control" %>
                </div>
              <div class='form-group'>
                <%= ff.label :account_type %>
                <%= ff.select :account_type, ["asset" , "equity" , "liability"],  { :include_blank => true }, { :class => "form-control" } %>
              </div>
              <div class='form-group'>
                <%= ff.label :amount %>
                <%= ff.text_field :amount, :class => "form-control" %>
              </div>
            <% end %>
        </div>
        <div id='credit_records' class='col-sm-6'>
          <h2>Credit Records</h2><button type="button" id='create_new_credit_entry' class="btn btn-default">Add new credit record</button>
            <%= f.fields_for :credit_records do |ff| %>
              <h4>Record</h4>
              <%= ff.hidden_field :id %>

              <div class='form-group'>
                <%= ff.label :account_name %>
                <%= ff.text_field :account_name, :class => "form-control" %>
                </div>
              <div class='form-group'>
                <%= ff.label :account_type %>
                <%= ff.select :account_type, ["asset" , "equity" , "liability"],  { :include_blank => true }, { :class => "form-control" } %>
              </div>
              <div class='form-group'>
                <%= ff.label :amount %>
                <%= ff.text_field :amount, :class => "form-control" %>
              </div>
              <% end %>
        </div>

      </div>
      <br />
      <div class='row'>
      <% if @accounting_transaction.id %>
        <div class='col-sm-6'><%= f.submit "update transaction" , :class => "btn btn-primary" %></div>
      <% else %>
        <div class='col-sm-6'><%= f.submit "create transaction" , :class => "btn btn-primary" %></div>
      <% end %>
      </div>
    <% end %>
    <br />  
  </div>
</div>